data cort;
input id trt trt_name$ event period priorprd self molt sex$ doy attck_time cort cort0 stress0 dGroup mixed_raptor mixed_human mixed_control 
self_raptor self_human prev_raptor prev_human;
datalines;
4	3	raptor	16	4	3	1	1	F	276	146	18.89853875	11.7092052	33.2288586	1	0	0	0	1	0	1	0
18	3	raptor	25	4	3	1	0	M	281	75	46.4524553	4.139182	32.9125266	1	0	0	0	1	0	1	0
5	3	raptor	11	4	2	0	1	F	272	95	27.6251261	14.550987	37.8637464	1	0	1	0	0	0	0	1
7	3	raptor	16	4	2	0	1	M	276	146	23.10384496	3.6423744	34.1005088	1	0	1	0	0	0	0	1
11	3	raptor	24	4	1	0	1	F	280	93	23.3892164	11.0796315	22.7774998	1	0	0	1	0	0	0	0
16	3	raptor	23	4	1	0	1	F	279	137	32.1180707	6.4583337	28.1747984	1	0	0	1	0	0	0	0
17	3	raptor	25	3	3	1	0	M	281	75	35.1627056	9.9938958	31.0615097	1	0	0	0	1	0	1	0
35	3	raptor	16	3	3	1	0	F	276	146	39.6309254	7.7785532	56.5140955	1	0	0	0	1	0	1	0
18	3	raptor	24	3	2	0	0	M	280	93	50.28285	4.139182	32.9125266	1	0	1	0	0	0	0	1
21	3	raptor	11	3	2	0	0	M	272	95	36.0355779	3.873688822	26.8834427	1	0	1	0	0	0	0	1
4	3	raptor	12	3	1	0	1	F	272	75	24.4647029	11.7092052	33.2288586	1	0	0	1	0	0	0	0
12	3	raptor	16	3	1	0	0	M	276	146	55.6148925	0.72245817	36.9401339	1	0	0	1	0	0	0	0
15	3	raptor	11	2	3	1	0	M	272	95	20.9281494	2.01598828	40.1802644	1	0	0	0	1	0	1	0
36	3	raptor	4	2	3	1	1	M	268	128	22.31404504	8.5174047	36.4414565	1	0	0	0	1	0	1	0
17	3	raptor	24	2	2	0	0	M	280	93	33.5155976	9.9938958	31.0615097	1	0	1	0	0	0	0	1
25	3	raptor	24	2	2	0	0	M	280	93	59.2939084	8.9047518	64.6339703	1	0	1	0	0	0	0	1
9	3	raptor	12	2	1	0	0	M	272	75	37.7960584	9.5717433	32.2538551	1	0	0	1	0	0	0	0
35	3	raptor	4	2	1	0	0	F	268	128	46.177503	7.7785532	56.5140955	1	0	0	1	0	0	0	0
15	3	raptor	4	1	0	0	0	M	268	128	16.61348803	2.01598828	40.1802644	1	0	0	0	0	0	0	0
19	3	raptor	4	1	0	0	1	F	268	128	37.108814	5.5865733	35.7930668	1	0	0	0	0	0	0	0
20	3	raptor	1	1	0	0	1	F	267	92	36.9401339	9.1334145	31.8490269	1	0	0	0	0	0	0	0
30	3	raptor	1	1	0	0	0	M	267	92	26.7635759	4.8081138	25.3454147	1	0	0	0	0	0	0	0
33	3	raptor	1	1	0	0	1	M	267	92	49.9797591	5.4783372	18.326248	1	0	0	0	0	0	0	0
36	3	raptor	1	1	0	0	1	M	267	92	17.37155882	8.5174047	36.4414565	1	0	0	0	0	0	0	0
12	2	human	20	4	3	0	0	M	277	150	39.6083418	0.72245817	36.9401339	1	1	0	0	0	0	1	0
35	2	human	20	4	3	0	0	F	277	150	19.9166344	7.7785532	56.5140955	1	1	0	0	0	0	1	0
9	2	human	18	4	2	1	0	M	276	99	28.77765583	9.5717433	32.2538551	1	0	0	0	0	1	0	1
30	2	human	22	4	2	1	0	M	278	101	18.8132902	4.8081138	25.3454147	1	0	0	0	0	1	0	1
15	2	human	14	4	1	0	0	M	275	92	20.9281494	2.01598828	40.1802644	1	0	0	1	0	0	0	0
33	2	human	14	4	1	0	1	M	275	92	5.834829	5.4783372	18.326248	1	0	0	1	0	0	0	0
9	2	human	15	3	3	0	0	M	275	108	26.8687573	9.5717433	32.2538551	1	1	0	0	0	0	1	0
36	2	human	14	3	3	0	1	M	275	92	20.812767	8.5174047	36.4414565	1	1	0	0	0	0	1	0
5	2	human	10	3	2	1	1	F	271	132	23.355341	14.550987	37.8637464	1	0	0	0	0	1	0	1
19	2	human	14	3	2	1	1	F	275	92	29.6891217	5.5865733	35.7930668	1	0	0	0	0	1	0	1
7	2	human	10	3	1	0	1	M	271	132	24.69545326	3.6423744	34.1005088	1	0	0	1	0	0	0	0
30	2	human	20	3	1	0	0	M	277	150	16.3638079	4.8081138	25.3454147	1	0	0	1	0	0	0	0
19	2	human	5	2	3	0	1	F	269	82	27.7301762	5.5865733	35.7930668	1	1	0	0	0	0	1	0
20	2	human	5	2	3	0	1	F	269	82	11.4855281	9.1334145	31.8490269	1	1	0	0	0	0	1	0
16	2	human	15	2	2	1	1	F	275	108	20.4500206	6.4583337	28.1747984	1	0	0	0	0	1	0	1
21	2	human	9	2	2	1	0	M	270	75	20.8414106	3.873688822	26.8834427	1	0	0	0	0	1	0	1
5	2	human	9	2	1	0	1	F	270	75	19.2759914	14.550987	37.8637464	1	0	0	1	0	0	0	0
18	2	human	15	2	1	0	0	M	275	108	4.91931711	4.139182	32.9125266	1	0	0	1	0	0	0	0
4	2	human	5	1	0	0	1	F	269	82	25.3454147	11.7092052	33.2288586	1	0	0	0	0	0	0	0
11	2	human	3	1	0	0	1	F	267	75	16.1160044	11.0796315	22.7774998	1	0	0	0	0	0	0	0
16	2	human	3	1	0	0	1	F	267	75	31.0615097	6.4583337	28.1747984	1	0	0	0	0	0	0	0
17	2	human	15	1	0	0	0	M	275	108	14.8618975	9.9938958	31.0615097	1	0	0	0	0	0	0	0
21	2	human	3	1	0	0	0	M	267	75	21.0153225	3.873688822	26.8834427	1	0	0	0	0	0	0	0
25	2	human	18	1	0	0	0	M	276	99	22.0056578	8.9047518	64.6339703	1	0	0	0	0	0	0	0
17	1	control	26	4	3	0	0	M	282	127	5.2698387	9.9938958	31.0615097	1	1	0	0	0	0	1	0
21	1	control	13	4	3	0	0	M	273	95	8.70877752	3.873688822	26.8834427	1	1	0	0	0	0	1	0
19	1	control	17	4	2	0	1	F	276	118	12.6636951	5.5865733	35.7930668	1	0	1	0	0	0	0	1
36	1	control	17	4	2	0	1	M	276	118	0	8.5174047	36.4414565	1	0	1	0	0	0	0	1
20	1	control	13	4	1	1	1	F	273	95	10.0490313	9.1334145	31.8490269	1	0	0	0	0	0	0	0
25	1	control	26	4	1	1	0	M	282	127	5.03985758	8.9047518	64.6339703	1	0	0	0	0	0	0	0
15	1	control	13	3	3	0	0	M	273	95	8.9554332	2.01598828	40.1802644	1	1	0	0	0	0	1	0
25	1	control	27	3	3	0	0	M	281	122	5.95671033	8.9047518	64.6339703	1	1	0	0	0	0	1	0
16	1	control	21	3	2	0	1	F	278	78	2.2651398	6.4583337	28.1747984	1	0	1	0	0	0	0	1
20	1	control	8	3	2	0	1	F	270	144	10.3918311	9.1334145	31.8490269	1	0	1	0	0	0	0	1
11	1	control	17	3	1	1	1	F	276	118	5.9765391	11.0796315	22.7774998	1	0	0	0	0	0	0	0
33	1	control	8	3	1	1	1	M	270	144	5.8614707	5.4783372	18.326248	1	0	0	0	0	0	0	0
30	1	control	17	2	3	0	0	M	276	118	8.435196	4.8081138	25.3454147	1	1	0	0	0	0	1	0
33	1	control	7	2	3	0	1	M	269	75	0	5.4783372	18.326248	1	1	0	0	0	0	1	0
4	1	control	8	2	2	0	1	F	270	144	8.6859654	11.7092052	33.2288586	1	0	1	0	0	0	0	1
11	1	control	6	2	2	0	1	F	269	85	8.7723972	11.0796315	22.7774998	1	0	1	0	0	0	0	1
7	1	control	8	2	1	1	1	M	270	144	11.9344953	3.6423744	34.1005088	1	0	0	0	0	0	0	0
12	1	control	6	2	1	1	0	M	269	85	4.8815991	0.72245817	36.9401339	1	0	0	0	0	0	0	0
35	1	control	2	1	0	0	0	F	267	76	4.63628885	7.7785532	56.5140955	1	0	0	0	0	0	0	0
5	1	control	2	1	0	0	1	F	267	76	6.94028671	14.550987	37.8637464	1	0	0	0	0	0	0	0
7	1	control	6	1	0	0	1	M	269	85	13.1077779	3.6423744	34.1005088	1	0	0	0	0	0	0	0
9	1	control	6	1	0	0	0	M	269	85	12.6636951	9.5717433	32.2538551	1	0	0	0	0	0	0	0
12	1	control	2	1	0	0	0	M	267	76	8.2747224	0.72245817	36.9401339	1	0	0	0	0	0	0	0
18	1	control	2	1	0	0	0	M	267	76	1.90739136	4.139182	32.9125266	1	0	0	0	0	0	0	0
;
*proc print; *run;

title 'Assess necessity of carryover (CO) x CO type interaction';
proc mixed order=data; 
class trt event period priorprd self molt sex (ref = "F") id prev_human prev_raptor self_human self_raptor;
model cort = trt period priorprd self priorprd*self molt sex attck_time cort0 / noint ddfm=kr s;
random id;
repeated / group=trt;
run;

* Drop the unnecessary carryover effect x carryover type interaction;
title 'Final model - no CO x CO type interaction';
proc mixed order=data; 
class trt event period priorprd self molt sex (ref = "F") id prev_human prev_raptor self_human self_raptor;
model cort = trt period priorprd self molt sex attck_time cort0 / noint ddfm=kr s;
random id;
repeated / group=trt;
lsmeans trt / pdiff cl adjust=tukey;
run;
